(this["webpackJsonpgoit-react-hw-04-hooks-images"]=this["webpackJsonpgoit-react-hw-04-hooks-images"]||[]).push([[0],{32:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(5),s=n.n(a),o=(n(31),n(32),n(4)),i=n(1);function u(e){var t=e.getSearchValue,n=Object(r.useState)(""),c=Object(o.a)(n,2),a=c[0],s=c[1];return Object(i.jsx)("header",{className:"Searchbar",children:Object(i.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.log("Before fetch:",a),t(a)},className:"SearchForm",children:[Object(i.jsx)("button",{type:"submit",className:"SearchForm-button",children:Object(i.jsx)("span",{className:"SearchForm-button-label",children:"Search"})}),Object(i.jsx)("input",{className:"SearchForm-input",type:"text",autoComplete:"off",autoFocus:!0,placeholder:"Search images and photos",onChange:function(e){s(e.target.value)}})]})})}var l=n(13),h=n(10),j=(n(34),n(35),n(22)),d=n.n(j),b=function(e){var t=e.children;return Object(i.jsx)("ul",{className:"ImageGallery",children:t})},p=n(2),g=n.n(p),f=function(e){var t=e.searchResults,n=e.openModal;return Object(i.jsx)(i.Fragment,{children:t.map((function(e){var t=e.id,r=e.webformatURL,c=e.tags;return Object(i.jsx)("li",{id:t,onClick:n,className:"ImageGalleryItem",children:Object(i.jsx)("img",{src:r,alt:c,className:"ImageGalleryItem-image"})},t)}))})},m=f;f.propType={searchResults:g.a.arrayOf({webformatURL:g.a.string.isRequired,tags:g.a.string,id:g.a.number}),openModal:g.a.func.isRequired};var O=n(12),v=n.n(O),x=n(23),y=n(24),w=n(25),S=n(26),k=n.n(S),N=function(){function e(t,n){Object(y.a)(this,e),this.BASE_URL=t,this.API_KEY=n,this._searchQuery="",this._page=1,this.perPage=12,this.urlWithKey=""}return Object(w.a)(e,[{key:"searchQuery",get:function(){return this._searchQuery},set:function(e){return this._searchQuery=e}},{key:"page",get:function(){return this._page},set:function(e){return this._page+=e}},{key:"resetPage",value:function(){return this._page=1}},{key:"searchPhotos",value:function(){var e=Object(x.a)(v.a.mark((function e(){var t,n,r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.urlWithKey=this.BASE_URL+"?key=".concat(this.API_KEY),console.log(this.searchQuery,this.page),t="&q=".concat(this._searchQuery,"&page=").concat(this.page,"&per_page=").concat(this.perPage),n=this.urlWithKey+t,e.prev=4,e.next=7,k.a.get(n);case 7:return r=e.sent,c=r.data.hits,e.abrupt("return",c);case 12:return e.prev=12,e.t0=e.catch(4),e.abrupt("return",console.log(e.t0));case 15:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),_=function(e){var t=e.onClick;return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)("button",{className:"btn-load",type:"button",onClick:t,children:"Load more"})})},E=(n(75),document.querySelector("#modal-root"));function F(e){var t=e.children,n=e.onClose;Object(r.useEffect)((function(){return window.addEventListener("keydown",c),function(){window.removeEventListener("keydown",c)}}));var c=function(e){"Escape"===e.code&&n()};return Object(a.createPortal)(Object(i.jsx)("div",{className:"Overlay",onClick:function(e){e.currentTarget===e.target&&n()},children:Object(i.jsx)("div",{className:"Modal",children:t})}),E)}var I=new N("https://pixabay.com/api/","23189092-912e167e41c5e7d499821c37e");function C(e){var t=e.searchValue,n=Object(r.useState)([]),c=Object(o.a)(n,2),a=c[0],s=c[1],u=Object(r.useState)("idle"),j=Object(o.a)(u,2),p=j[0],g=j[1],f=Object(r.useState)(null),O=Object(o.a)(f,2),v=O[0],x=O[1],y=Object(r.useState)(!1),w=Object(o.a)(y,2),S=w[0],k=w[1];Object(r.useEffect)((function(){t&&(g("pending"),h.b.info("Enter other data or check the word for mistakes",{autoClose:3e3,position:"top-center"}),I.resetPage(),I.searchQuery=t,I.searchPhotos().then((function(e){g("resolved"),s(e)})).catch((function(e){console.log(e),h.b.warn("Uppps, error"),g("rejected")})))}),[t]);var N=function(){return a.find((function(e){return e.id===v}))},E=a.length>0&&a.length>=12;return"idle"===p?Object(i.jsx)("div",{className:"container-title",children:Object(i.jsx)("p",{children:"You can find any pictures, photos and images here"})}):"pending"===p?Object(i.jsx)("div",{className:"loader",children:Object(i.jsx)(d.a,{type:"MutatingDots",color:"#00BFFF",height:100,width:100,timeout:3e3})}):"rejected"===p?Object(i.jsx)("div",{className:"container-title",children:Object(i.jsx)("p",{children:"Uppps, error"})}):"resolved"===p?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(b,{children:a.length>0&&Object(i.jsx)(m,{openModal:function(e){k(!0),x(Number(e.currentTarget.id))},searchResults:a})}),E>0&&Object(i.jsx)(_,{onClick:function(){I.page=1,I.searchPhotos().then((function(e){s((function(t){return[].concat(Object(l.a)(t),Object(l.a)(e))})),g("resolved")})).then((function(){window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})})).catch((function(e){console.log(e),g("rejected")}))}}),0===a.length&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("div",{className:"container-title",children:Object(i.jsx)("p",{children:"Sorry, we did not find this"})}),Object(i.jsx)(h.a,{})]}),S&&Object(i.jsx)(F,{largeImageId:v,onClose:function(){return k(!1)},children:Object(i.jsx)("img",{src:N().largeImageURL,alt:N().tags})})]}):void 0}function P(){var e=Object(r.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(i.jsxs)("div",{children:[Object(i.jsx)(u,{getSearchValue:function(e){return c(e)}}),Object(i.jsx)(C,{searchValue:n})]})}s.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(P,{})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.db9599b3.chunk.js.map